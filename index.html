<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>NEXUS | Ultimate DeFi</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <style>
        :root {
            --bg: #050505;
            --surface: #121212;
            --surface-light: #1e1e1e;
            --primary: #00ffa3;
            --primary-glow: rgba(0, 255, 163, 0.4);
            --danger: #ff4757;
            --text: #ffffff;
            --text-dim: #888888;
        }

        * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; outline: none; }

        body {
            background-color: var(--bg);
            color: var(--text);
            font-family: 'Inter', -apple-system, sans-serif;
            margin: 0;
            height: 100vh;
            display: flex;
            flex-direction: column;
            overflow: hidden;
        }

        /* --- Animations --- */
        @keyframes press { 0% { transform: scale(1); } 50% { transform: scale(0.95); } 100% { transform: scale(1); } }
        @keyframes spin { to { transform: rotate(360deg); } }
        @keyframes slideUp { from { transform: translateY(100%); opacity: 0; } to { transform: translateY(0); opacity: 1; } }
        @keyframes popIn { from { transform: scale(0.8); opacity: 0; } to { transform: scale(1); opacity: 1; } }

        /* --- Header --- */
        header {
            padding: 15px 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            background: rgba(18, 18, 18, 0.8);
            backdrop-filter: blur(12px);
            border-bottom: 1px solid #333;
            z-index: 50;
        }

        .brand { font-size: 1.2rem; font-weight: 800; letter-spacing: -0.5px; display: flex; align-items: center; gap: 8px; }
        .brand i { color: var(--primary); }
        
        .wallet-badge {
            background: #222;
            border: 1px solid #444;
            padding: 6px 12px;
            border-radius: 20px;
            font-size: 0.75rem;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 6px;
            transition: 0.3s;
        }
        .wallet-badge.connected { border-color: var(--primary); background: rgba(0,255,163,0.1); color: var(--primary); }
        .dot { width: 8px; height: 8px; background: #666; border-radius: 50%; }
        .connected .dot { background: var(--primary); box-shadow: 0 0 8px var(--primary); }

        /* --- Main Content --- */
        main { flex: 1; overflow-y: auto; padding-bottom: 80px; position: relative; }

        .tab-view { display: none; padding: 20px; animation: popIn 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275); }
        .tab-view.active { display: block; }

        /* --- Dashboard Components --- */
        .hero-card {
            background: linear-gradient(145deg, var(--surface-light), var(--surface));
            border: 1px solid #333;
            padding: 25px;
            border-radius: 20px;
            text-align: center;
            margin-bottom: 25px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.3);
        }
        
        .balance-label { color: var(--text-dim); font-size: 0.9rem; text-transform: uppercase; letter-spacing: 1px; }
        .balance-val { font-size: 2.8rem; font-weight: 800; margin: 10px 0; text-shadow: 0 0 20px rgba(0,255,163,0.2); }
        .pnl { color: var(--primary); font-weight: 600; background: rgba(0,255,163,0.1); padding: 4px 12px; border-radius: 12px; display: inline-block; }

        /* --- Lists --- */
        .list-header { font-size: 1.1rem; font-weight: 700; margin-bottom: 15px; display: flex; justify-content: space-between; align-items: center; }
        .coin-item {
            display: flex; justify-content: space-between; align-items: center;
            background: var(--surface); padding: 16px; border-radius: 16px;
            margin-bottom: 12px; border: 1px solid #222;
            transition: 0.2s;
        }
        .coin-item:active { transform: scale(0.98); background: #222; }

        .coin-left { display: flex; align-items: center; gap: 12px; }
        .coin-icon { width: 44px; height: 44px; border-radius: 50%; background: #333; display: flex; align-items: center; justify-content: center; font-weight: bold; font-size: 1.2rem; }
        
        /* --- Buttons & Inputs --- */
        .btn {
            width: 100%; padding: 16px; border-radius: 14px;
            border: none; font-weight: 700; font-size: 1rem;
            cursor: pointer; transition: 0.2s;
            display: flex; justify-content: center; align-items: center; gap: 10px;
        }
        .btn-primary { background: var(--primary); color: #000; box-shadow: 0 5px 20px rgba(0,255,163,0.2); }
        .btn-primary:active { transform: scale(0.97); }
        .btn-outline { background: transparent; border: 1px solid #444; color: white; }
        .btn-sm { padding: 8px 16px; font-size: 0.85rem; width: auto; border-radius: 10px; }

        .input-box {
            background: var(--surface); border: 1px solid #333;
            padding: 18px; border-radius: 14px; width: 100%;
            color: white; font-size: 1rem; margin-bottom: 15px;
        }
        .input-box:focus { border-color: var(--primary); }

        /* --- Deposit Grid --- */
        .grid-options { display: grid; grid-template-columns: repeat(3, 1fr); gap: 10px; margin-bottom: 20px; }
        .grid-opt {
            background: var(--surface); border: 1px solid #333;
            padding: 15px; border-radius: 12px; text-align: center;
            font-weight: 600; cursor: pointer; transition: 0.2s;
        }
        .grid-opt.selected { border-color: var(--primary); background: rgba(0,255,163,0.05); color: var(--primary); }

        /* --- Bottom Nav --- */
        .nav-bar {
            position: fixed; bottom: 0; width: 100%;
            background: rgba(18, 18, 18, 0.95); backdrop-filter: blur(10px);
            border-top: 1px solid #333; padding: 10px 0 25px;
            display: grid; grid-template-columns: repeat(4, 1fr);
            z-index: 100;
        }
        .nav-item { text-align: center; color: #666; font-size: 0.7rem; cursor: pointer; transition: 0.2s; }
        .nav-item i { font-size: 1.3rem; margin-bottom: 5px; display: block; }
        .nav-item.active { color: var(--primary); }
        .nav-item.active i { transform: translateY(-2px); }

        /* --- Overlays --- */
        .toast {
            position: fixed; top: 80px; left: 50%; transform: translateX(-50%);
            background: #111; border: 1px solid var(--primary); color: var(--primary);
            padding: 12px 24px; border-radius: 30px; font-weight: 600; font-size: 0.9rem;
            box-shadow: 0 10px 40px rgba(0,0,0,0.5); display: none; z-index: 200;
            animation: popIn 0.3s;
        }

        .loader {
            width: 20px; height: 20px; border: 3px solid rgba(0,0,0,0.2);
            border-top-color: #000; border-radius: 50%;
            animation: spin 0.8s linear infinite; display: none;
        }
        .btn-primary .loader { border-top-color: #000; }
        .btn-outline .loader { border-top-color: #fff; }

        /* --- Chart --- */
        .chart-container { height: 180px; width: 100%; position: relative; margin-bottom: 20px; overflow: hidden; border-radius: 16px; border: 1px solid #333; }
        canvas { width: 100%; height: 100%; background: #0a0a0a; }

    </style>
</head>
<body>

    <header>
        <div class="brand"><i class="fas fa-cube"></i> NEXUS</div>
        <div class="wallet-badge" id="walletIndicator">
            <div class="dot"></div>
            <span id="walletText">Not Connected</span>
        </div>
    </header>

    <div class="toast" id="toast">Action Successful</div>

    <main>
        <div id="view-home" class="tab-view active">
            <div class="hero-card">
                <div class="balance-label">Total Portfolio</div>
                <div class="balance-val" id="mainBalance">0.00 SOL</div>
                <div class="pnl"><i class="fas fa-arrow-up"></i> +0.00% (24h)</div>
            </div>

            <div class="chart-container">
                <canvas id="priceChart"></canvas>
            </div>

            <div class="list-header">Your Assets</div>
            <div id="assetsList">
                <div class="coin-item">
                    <div class="coin-left">
                        <div class="coin-icon" style="background: #9945FF; color: white;">S</div>
                        <div>
                            <div style="font-weight:700">Solana</div>
                            <div style="font-size:0.8rem; color:#888">SOL</div>
                        </div>
                    </div>
                    <div style="text-align:right">
                        <div style="font-weight:700" id="solQty">0.00</div>
                        <div style="font-size:0.8rem; color:var(--primary)">$145.20</div>
                    </div>
                </div>
            </div>
        </div>

        <div id="view-market" class="tab-view">
            <div class="list-header">Trending Memecoins</div>
            <div id="marketList">
                </div>
        </div>

        <div id="view-create" class="tab-view">
            <div class="list-header">Launchpad</div>
            <div class="hero-card" style="text-align: left;">
                <h3 style="margin-top:0">Mint New Token</h3>
                <p style="color:#888; font-size:0.9rem; margin-bottom:20px">Create a meme coin on the testnet instantly. Cost: 1.0 SOL.</p>
                
                <input type="text" id="createName" class="input-box" placeholder="Token Name (e.g. MoonDog)">
                <input type="text" id="createTicker" class="input-box" placeholder="Ticker (e.g. MOON)">
                
                <button class="btn btn-primary" onclick="deployToken(this)">
                    <span>DEPLOY TOKEN</span>
                    <div class="loader"></div>
                </button>
            </div>
        </div>

        <div id="view-wallet" class="tab-view">
            <div class="list-header">Wallet Settings</div>
            
            <div class="hero-card">
                <div style="font-size:3rem; margin-bottom:15px"><i class="fas fa-wallet"></i></div>
                <div id="walletAddress" style="font-family:monospace; background:#222; padding:8px; border-radius:8px; margin-bottom:20px; font-size:0.9rem;">0x...</div>
                <button class="btn btn-primary" id="connectBtn" onclick="toggleWallet()">Connect Phantom</button>
            </div>

            <div class="list-header">Deposit Test Funds</div>
            <div class="grid-options">
                <div class="grid-opt" onclick="selectAmt(10, this)">10 SOL</div>
                <div class="grid-opt" onclick="selectAmt(50, this)">50 SOL</div>
                <div class="grid-opt" onclick="selectAmt(100, this)">100 SOL</div>
            </div>
            
            <button class="btn btn-outline" onclick="processDeposit(this)">
                <span>CONFIRM DEPOSIT</span>
                <div class="loader"></div>
            </button>
        </div>
    </main>

    <div class="nav-bar">
        <div class="nav-item active" onclick="nav('home')">
            <i class="fas fa-home"></i> Home
        </div>
        <div class="nav-item" onclick="nav('market')">
            <i class="fas fa-rocket"></i> Market
        </div>
        <div class="nav-item" onclick="nav('create')">
            <i class="fas fa-plus-square"></i> Create
        </div>
        <div class="nav-item" onclick="nav('wallet')">
            <i class="fas fa-wallet"></i> Wallet
        </div>
    </div>

    <script>
        // --- GLOBAL STATE ---
        let state = {
            balance: 0.00,
            connected: false,
            selectedDeposit: 0,
            portfolio: {}
        };

        // --- MARKET DATA ---
        const marketData = [
            { name: "Bonk", ticker: "BONK", color: "#e17055", change: "+12.5%" },
            { name: "Pepe", ticker: "PEPE", color: "#00b894", change: "+45.2%" },
            { name: "Dogwifhat", ticker: "WIF", color: "#fdcb6e", change: "+8.1%" }
        ];

        // --- INIT ---
        window.onload = () => {
            renderMarket();
            renderBalance();
            initChart();
        };

        // --- NAVIGATION ---
        function nav(tabName) {
            // Update Icons
            document.querySelectorAll('.nav-item').forEach(el => el.classList.remove('active'));
            event.currentTarget.classList.add('active');

            // Switch View
            document.querySelectorAll('.tab-view').forEach(el => el.classList.remove('active'));
            document.getElementById('view-' + tabName).classList.add('active');
        }

        // --- WALLET SYSTEM ---
        function toggleWallet() {
            const btn = document.getElementById('connectBtn');
            const indicator = document.getElementById('walletIndicator');
            const txt = document.getElementById('walletText');
            const addr = document.getElementById('walletAddress');

            btn.innerHTML = '<div class="loader" style="display:block"></div>'; // Show loader

            setTimeout(() => {
                if(!state.connected) {
                    // CONNECT
                    state.connected = true;
                    btn.innerHTML = "Disconnect Wallet";
                    btn.style.background = "#333";
                    btn.style.color = "#fff";
                    
                    indicator.classList.add('connected');
                    txt.innerText = "0x7A...9fK2";
                    addr.innerText = "0x7A82...9fK2 (Active)";
                    showToast("Wallet Connected Successfully");
                } else {
                    // DISCONNECT
                    state.connected = false;
                    state.balance = 0;
                    btn.innerHTML = "Connect Phantom";
                    btn.style.background = "var(--primary)";
                    btn.style.color = "#000";
                    
                    indicator.classList.remove('connected');
                    txt.innerText = "Not Connected";
                    addr.innerText = "0x...";
                    renderBalance();
                    showToast("Wallet Disconnected");
                }
            }, 1000);
        }

        // --- DEPOSIT SYSTEM ---
        function selectAmt(amount, el) {
            // Visual Selection
            document.querySelectorAll('.grid-opt').forEach(opt => opt.classList.remove('selected'));
            el.classList.add('selected');
            state.selectedDeposit = amount;
        }

        function processDeposit(btn) {
            if(!state.connected) return showToast("Please Connect Wallet First!");
            if(state.selectedDeposit === 0) return showToast("Select an Amount");

            const originalText = btn.innerHTML;
            btn.innerHTML = '<div class="loader" style="display:block"></div>'; // Show spinner

            setTimeout(() => {
                state.balance += state.selectedDeposit;
                renderBalance();
                showToast(`Received ${state.selectedDeposit} SOL`);
                btn.innerHTML = originalText;
                // Reset selection
                document.querySelectorAll('.grid-opt').forEach(opt => opt.classList.remove('selected'));
                state.selectedDeposit = 0;
            }, 1500);
        }

        function renderBalance() {
            document.getElementById('mainBalance').innerText = state.balance.toFixed(2) + " SOL";
            document.getElementById('solQty').innerText = state.balance.toFixed(2);
        }

        // --- TRADING SYSTEM ---
        function renderMarket() {
            const list = document.getElementById('marketList');
            list.innerHTML = '';
            marketData.forEach(coin => {
                const item = `
                <div class="coin-item">
                    <div class="coin-left">
                        <div class="coin-icon" style="background:${coin.color}; color:black">${coin.ticker[0]}</div>
                        <div>
                            <div style="font-weight:700">$${coin.ticker}</div>
                            <div style="font-size:0.8rem; color:${coin.change.includes('+') ? 'var(--primary)' : 'red'}">${coin.change}</div>
                        </div>
                    </div>
                    <button class="btn btn-sm btn-primary" onclick="buyCoin('${coin.ticker}', 5, this)">
                        BUY (5 SOL)
                    </button>
                </div>`;
                list.innerHTML += item;
            });
        }

        function buyCoin(ticker, cost, btn) {
            if(!state.connected) return showToast("Connect Wallet!");
            if(state.balance < cost) return showToast("Insufficient SOL!");

            const originalText = btn.innerText;
            btn.innerText = "...";
            btn.style.opacity = "0.7";

            setTimeout(() => {
                // 1. Deduct Cost
                state.balance -= cost;
                
                // 2. Simulate HUGE Profit
                const profit = cost * (1.5 + Math.random()); // 1.5x to 2.5x multiplier
                state.balance += profit;
                
                renderBalance();
                showToast(`Sold ${ticker}! Profit: +${(profit - cost).toFixed(2)} SOL`);
                
                // Reset Button
                btn.innerText = originalText;
                btn.style.opacity = "1";
                
                // Spike Chart
                spikeChart();
            }, 1500);
        }

        // --- TOKEN CREATOR ---
        function deployToken(btn) {
            if(!state.connected) return showToast("Connect Wallet!");
            const name = document.getElementById('createName').value;
            const ticker = document.getElementById('createTicker').value.toUpperCase();

            if(!name || !ticker) return showToast("Enter Name & Ticker");
            if(state.balance < 1) return showToast("Need 1 SOL for Gas");

            const loader = btn.querySelector('.loader');
            const span = btn.querySelector('span');
            
            span.style.display = 'none';
            loader.style.display = 'block';

            setTimeout(() => {
                state.balance -= 1;
                renderBalance();
                
                // Add to Market Data
                marketData.unshift({
                    name: name,
                    ticker: ticker,
                    color: "#" + Math.floor(Math.random()*16777215).toString(16),
                    change: "NEW ðŸš€"
                });
                renderMarket(); // Re-render list
                
                // Switch to Market Tab to show it
                nav('market');
                showToast(`${ticker} Deployed Successfully!`);
                
                // Reset Form
                document.getElementById('createName').value = '';
                document.getElementById('createTicker').value = '';
                span.style.display = 'block';
                loader.style.display = 'none';
            }, 2000);
        }

        // --- UI UTILS ---
        function showToast(msg) {
            const t = document.getElementById('toast');
            t.innerText = msg;
            t.style.display = 'block';
            setTimeout(() => t.style.display = 'none', 3000);
        }

        // --- CHART LOGIC (Pure Canvas) ---
        let chartPoints = [];
        const canvas = document.getElementById('priceChart');
        const ctx = c
